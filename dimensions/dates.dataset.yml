unique_name: dates.dataset
object_type: dataset
label: dates
connection_id: snowflake_partner.connection
sql: |-
  SELECT DISTINCT
      CAST(START_TIME AS DATE) AS use_date,
      YEAR(START_TIME) AS "Year",
      MONTHNAME(START_TIME) AS "Month",
      MONTH(START_TIME) AS month_number,                -- 1 = January, 12 = December
      13 - MONTH(START_TIME) AS month_number_desc       -- 12 = January, 1 = December
  FROM SNOWFLAKE.ACCOUNT_USAGE.warehouse_metering_history

  UNION

  SELECT DISTINCT
      CAST(END_TIME AS DATE) AS use_date,
      YEAR(END_TIME) AS "Year",
      MONTHNAME(END_TIME) AS "Month",
      MONTH(END_TIME) AS month_number,
      13 - MONTH(END_TIME) AS month_number_desc
  FROM SNOWFLAKE.ACCOUNT_USAGE.warehouse_metering_history

  UNION

  SELECT DISTINCT
      CAST(START_TIME AS DATE) AS use_date,
      YEAR(START_TIME) AS "Year",
      MONTHNAME(START_TIME) AS "Month",
      MONTH(START_TIME) AS month_number,
      13 - MONTH(START_TIME) AS month_number_desc
  FROM SNOWFLAKE.ACCOUNT_USAGE.query_history

  UNION

  SELECT DISTINCT
      CAST(END_TIME AS DATE) AS use_date,
      YEAR(END_TIME) AS "Year",
      MONTHNAME(END_TIME) AS "Month",
      MONTH(END_TIME) AS month_number,
      13 - MONTH(END_TIME) AS month_number_desc
  FROM SNOWFLAKE.ACCOUNT_USAGE.query_history

columns:
  - name: Month
    data_type: string
  - name: MONTH_NUMBER
    data_type: "decimal(2,0)"
  - name: MONTH_NUMBER_DESC
    data_type: "decimal(3,0)"
  - name: USE_DATE
    data_type: date
  - name: Year
    data_type: "decimal(4,0)"
